---
title: Microsoft identity platform JavaScript quickstart | Azure
description: Learn how JavaScript applications can call an API that require access tokens by Microsoft identity platform.
services: active-directory
documentationcenter: dev-center-name
author: navyasric
manager: CelesteDG
editor: ''

ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: quickstart
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/11/2019
ms.author: nacanuma
ms.custom: aaddev

#Customer intent: As an app developer, I want to learn how to get access tokens using the Microsoft identity platform endpoint so that my JavaScript app can sign in personal and work and school accounts.
ms.collection: M365-identity-device-management
---

# Quickstart: Sign in users and acquire an access token from a JavaScript single-page application (SPA)

[!INCLUDE [active-directory-develop-applies-v2-msal](../../../includes/active-directory-develop-applies-v2-msal.md)]

In this quickstart, you'll learn how to use a code sample that demonstrates how a JavaScript single-page application (SPA) can sign in personal accounts, work and school accounts and get an access token to call the Microsoft Graph API or any web API.

![Shows how the sample app generated by this quickstart works](media/quickstart-v2-javascript/javascriptspa-intro.svg)

## Prerequisites

You will need the following setup for this quickstart:
* To run the project with a node.js server,
    * Install [Node.js](https://nodejs.org/en/download/)
    * Install [Visual Studio Code](https://code.visualstudio.com/download) to edit the project files
* To run the project as a Visual Studio solution, install [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/).

> [!div renderon="docs"]
> ## Register and download your quickstart application
> You have two options to start your quickstart application:
> * [Express] [Option 1: Register and auto configure your app and then download your code sample](#option-1-register-and-auto-configure-your-app-and-then-download-your-code-sample)
> * [Manual] [Option 2: Register and manually configure your application and code sample](#option-2-register-and-manually-configure-your-application-and-code-sample)
>
> ### Option 1: Register and auto configure your app and then download your code sample
>
> 1. Sign in to the [Azure portal](https://portal.azure.com) using either a work or school account, or a personal Microsoft account.
> 1. If your account gives you access to more than one tenant, select your account in the top right corner, and set your portal session to the desired Azure AD tenant.
> 1. Go to the new [Azure portal - App registrations](https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/applicationsListBlade/quickStartType/JavascriptSpaQuickstartPage/sourceType/docs) pane.
> 1. Enter a name for your application and click **Register**.
> 1. Follow the instructions to download and automatically configure your new application for you in one click.
>
> ### Option 2: Register and manually configure your application and code sample
>
> #### Step 1: Register your application
>
> 1. Sign in to the [Azure portal](https://portal.azure.com) using either a work or school account, or a personal Microsoft account.
> 1. If your account gives you access to more than one tenant, select your account in the top right corner, and set your portal session to the desired Azure AD tenant.
> 1. Navigate to the Microsoft identity platform for developers [App registrations](https://go.microsoft.com/fwlink/?linkid=2083908) page.
> 1. Select **New registration**.
> 1. When the **Register an application** page appears, enter a name for your application.
> 1. Under **Supported account types**, select **Accounts in any organizational directory and personal Microsoft accounts**.
> 1. Select the **Web** platform under the **Redirect URI** section and set the value to `http://localhost:30662/`.
> 1. When finished, select **Register**.  On the app **Overview** page, note down the **Application (client) ID** value.
> 1. This quickstart requires the [Implicit grant flow](v2-oauth2-implicit-grant-flow.md) to be enabled. In the left-hand navigation pane of the registered application, select **Authentication**.
> 1. In **Advanced settings**, under **Implicit grant**, enable both **ID tokens** and **Access tokens** checkboxes. ID tokens and access tokens are required since this app needs to sign in users and call an API.
> 1. Select **Save**.

> [!div class="sxs-lookup" renderon="portal"]
> #### Step 1: Configure your application in the Azure portal
> For the code sample for this quickstart to work, you need to add a redirect URI as `http://localhost:30662/` and enable **Implicit Grant**.
> > [!div renderon="portal" id="makechanges" class="nextstepaction"]
> > [Make these changes for me]()
>
> > [!div id="appconfigured" class="alert alert-info"]
> > ![Already configured](media/quickstart-v2-javascript/green-check.png) Your application is configured with these attributes.

#### Step 2: Download the project

You can choose one of these options suitable to your development environment.
* [Download the core project files - for a web server, such as Node.js](https://github.com/Azure-Samples/active-directory-javascript-graphapi-v2/archive/quickstart.zip)
* [Download the Visual Studio project](https://github.com/Azure-Samples/active-directory-javascript-graphapi-v2/archive/vsquickstart.zip)

Extract the zip file to a local folder, for example, **C:\Azure-Samples**.
To open the files in the folder, use an editor like [Visual Studio Code](https://code.visualstudio.com/).

#### Step 3: Configure your JavaScript app

> [!div renderon="docs"]
> Under the folder *JavaScriptSPA*, edit `index.html` and set the `clientID` and `authority` values under `applicationConfig`.

> [!div class="sxs-lookup" renderon="portal"]
> Under the folder *JavaScriptSPA*, edit `index.html` and replace `applicationConfig` with:

```javascript
var applicationConfig = {
    clientID: "Enter_the_Application_Id_here",
    authority: "https://login.microsoftonline.com/Enter_the_Tenant_Info_Here",
    graphScopes: ["user.read"],
    graphEndpoint: "https://graph.microsoft.com/v1.0/me"
};
```
> [!div renderon="docs"]
>
> Where:
> - `Enter_the_Application_Id_here` - is the **Application (client) ID** for the application you registered.
> - `Enter_the_Tenant_Info_Here` - is set to one of the following options:
>   - If your application supports **Accounts in this organizational directory**, replace this value with the **Tenant Id** or **Tenant name** (for example, contoso.microsoft.com)
>   - If your application supports **Accounts in any organizational directory**, replace this value with `organizations`
>   - If your application supports **Accounts in any organizational directory and personal Microsoft accounts**, replace this value with `common`
>
> > [!TIP]
> > To find the values of **Application (client) ID**, **Directory (tenant) ID**, and **Supported account types**, go to the app's **Overview** page in the Azure portal.

#### Step 4: Run the project

* If you're using [Node.js](https://nodejs.org/en/download/):

    1. Run the following command from the project's directory to start the server:

        ```batch
        npm install
        node server.js
        ```

    1. Open a web browser and navigate to `http://localhost:30662/`.
    1. Click **Sign In** button to start sign-in and then call Microsoft Graph API.


* If using [Visual Studio](https://visualstudio.microsoft.com/downloads/), make sure to select the project solution and then press **F5** to run your project.

After the browser loads the application, click **Sign In**.  The first time that you sign in, you're prompted to provide your consent to allow the application to access your profile and to sign you in. On successful sign in, you should see your user profile information displayed on the page.

## More Information

### *msal.js*

MSAL is the library used to sign in users and request tokens used to access an API protected by Microsoft identity platform. The quickstart's *index.html* contains a reference to the library:

```html
<script src="https://secure.aadcdn.microsoftonline-p.com/lib/0.2.4/js/msal.min.js"></script>
```

Alternatively, if you have Node installed, you can download it through npm:

```batch
npm install msal
```

### MSAL initialization

The quickstart code also shows how to initialize the library:

```javascript
var myMSALObj = new Msal.UserAgentApplication(applicationConfig.clientID, applicationConfig.authority, acquireTokenRedirectCallBack, {storeAuthStateInCookie: true, cacheLocation: "localStorage"});
```

> |Where  |  |
> |---------|---------|
> |`ClientId`     |Application ID from the application registered in the Azure portal|
> |`authority`    |It is the authority URL. Passing *null* sets the default authority to `https://login.microsoftonline.com/common`. If your app is single-tenant (targeting accounts in one directory only), set this value to `https://login.microsoftonline.com/<tenant name or ID>`|
> |`tokenReceivedCallback`| Callback method called after the authentication redirects back to the app. Here, `acquireTokenRedirectCallBack` is passed. This is null if using loginPopup.|
> |`options`  |A collection of optional parameters. In this case `storeAuthStateInCookie` and `cacheLocation` are optional configuration. See the [wiki](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics#configuration-options) for more details on the options. |

### Sign in users

The following code snippet shows how to sign in users:

```javascript
myMSALObj.loginPopup(applicationConfig.graphScopes).then(function (idToken) {
    //Callback code here
})
```

> |Where  |  |
> |---------|---------|
> | `scopes`   | (Optional) Contains scopes being requested for user consent at login time. For example, `[ "user.read" ]` for Microsoft Graph or `[ "<Application ID URL>/scope" ]` for custom Web APIs ( that is, `api://<Application ID>/access_as_user` ). Here, `applicationConfig.graphScopes` is passed. |

> [!TIP]
> Alternatively, you may want to use the `loginRedirect` method to redirect the current page to the sign-in page instead of a popup window.

### Request tokens

MSAL has three methods used to acquire tokens: `acquireTokenRedirect`, `acquireTokenPopup` and `acquireTokenSilent`

#### Get a user token silently

The `acquireTokenSilent` method handles token acquisitions and renewal without any user interaction. After the `loginRedirect` or `loginPopup` method is executed for the first time, `acquireTokenSilent` is the method commonly used to obtain tokens that are used to access protected resources for subsequent calls. Calls to request or renew tokens are made silently.

```javascript
myMSALObj.acquireTokenSilent(applicationConfig.graphScopes).then(function (accessToken) {
    // Callback code here
})
```

> |Where  |  |
> |---------|---------|
> | `scopes`   | Contains scopes being requested to be returned in the access token for API. For example, `[ "user.read" ]` for Microsoft Graph or `[ "<Application ID URL>/scope" ]` for custom Web APIs (that is, `api://<Application ID>/access_as_user`). Here, `applicationConfig.graphScopes` is passed.|

#### Get a user token interactively

There are situations where you need to force users to interact with Microsoft identity platform endpoint. For example:
* Users may need to reenter their credentials because their password has expired
* Your application is requesting access to additional resource scopes that the user needs to consent to
* Two factor authentication is required

The usual recommended pattern for most applications is to call `acquireTokenSilent` first, then catch the exception and then call `acquireTokenRedirect` (or `acquireTokenPopup`) to start an interactive request.

Calling the `acquireTokenPopup(scope)` results in a popup window to sign in (or `acquireTokenRedirect(scope)` results in redirecting users to the Microsoft identity platform endpoint) where users need to interact by either confirming their credentials, giving the consent to the required resource, or completing the two factor authentication.

```javascript
myMSALObj.acquireTokenPopup(applicationConfig.graphScopes).then(function (accessToken) {
    // Callback code here
})
```

> [!NOTE]
> This quickstart uses the `loginRedirect` and `acquireTokenRedirect` methods  when the browser used is Internet Explorer due to a [known issue](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Known-issues-on-IE-and-Edge-Browser#issues) related to handling of popup windows by Internet Explorer browser.

## Next steps

For a more detailed step-by-step guide on how to build the application for this quickstart, try out the JavaScript tutorial below.

### Learn the steps to create the application for this quickstart

> [!div class="nextstepaction"]
> [Tutorial to sign in and call MS Graph](https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa)

### Browse the MSAL repo for documentation, FAQ, issues, and more

> [!div class="nextstepaction"]
> [MSAL.js GitHub repo](https://github.com/AzureAD/microsoft-authentication-library-for-js)
